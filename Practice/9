#include <iostream>
#include <string>
#include <cmath>
using namespace std;

int to_hex(int A, int q)
{
	int B = 0;
	for (int i = 0; A > 0; i++)
	{
		B = B + (A % 10 * pow(q, i));
		A = A / 10;
	}
	return B;
}

string to_bin(int a, int q)
{
	int rem = 0;
	double ned = 0;
	int* mas = new int[50];
	int j = 0;
	while (a > 0)
	{
		ned = floor(a / q);
		rem = a - (ned * q);
		a = ned;
		mas[j] = rem;
		j++;
	}
	string bin = "";
	for (int i = j - 1; i >= 0; i--)
	{
		bin += to_string(mas[i]);
	}
	return bin;
}

int check(int h, int p)
{
	int a;
	for (int i = 0; h > 0; i++)
	{
		a = h % 10;
		if (a >= p)
		{
			cout << "Число нарушает правила заданной системы счисления!" << endl;
			system("pause");
			exit(0);
		}
		else h = h / 10;
	}
	return 0;
}


int main()
{
	setlocale(0, "");
	int h1, h2;
	int p1, p2;
	cout << "Введите первое число и его основание системы счисления: ";
	cin >> h1 >> p1;
	if (p1 > 16 || p1 == 7 || p1 == 9 || p1 == 11 || p1 == 13 || p1 == 14 || p1 == 15)
	{
		cout << "Ошибка при вводе системы счисления." << endl;
		system("pause");
		return 0;
	}
	check(h1, p1);
	cout << "Введите второе число и его основание системы счисления: ";
	cin >> h2 >> p2;
	if (p2 > 16 || p2 == 7 || p2 == 9 || p2 == 11 || p2 == 13 || p2 == 14 || p2 == 15)
	{
		cout << "Ошибка при вводе системы счисления." << endl;
		system("pause");
		return 0;
	}
	check(h2, p2);
	int sum = 0;
	sum = to_hex(h1, p1) + to_hex(h2, p2);
	cout << "Сумма в";
	switch (p1)
	{
	case 2:
		cout << " двоичном ";
		break;
	case 3:
		cout << " троичном ";
		break;
	case 4:
		cout << " четверичном ";
		break;
	case 5:
		cout << " пятеричном ";
		break;
	case 6:
		cout << " шестиричном ";
		break;
	case 8:
		cout << " восьмиричном ";
		break;
	case 10:
		cout << " десятиричном ";
		break;
	case 12:
		cout << " двенадцатиричном ";
		break;
	case 16:
		cout << " шестнадцатиричном ";
		break;
	}
	cout << "виде: " << to_bin(sum, p1) << endl;
	if (p1 != p2)
	{
		cout << "Сумма в";
		switch (p2)
		{
		case 2:
			cout << " двоичном ";
			break;
		case 3:
			cout << " троичном ";
			break;
		case 4:
			cout << " четверичном ";
			break;
		case 5:
			cout << " пятеричном ";
			break;
		case 6:
			cout << " шестиричном ";
			break;
		case 8:
			cout << " восьмиричном ";
			break;
		case 10:
			cout << " десятиричном ";
			break;
		case 12:
			cout << " двенадцатиричном ";
			break;
		case 16:
			cout << " шестнадцатиричном ";
			break;
		}
		cout << "виде: " << to_bin(sum, p2) << endl;
	}
	else
	{
		system("pause");
		return 0;
	}
	system("pause");
	return 0;
}
